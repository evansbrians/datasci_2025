---
title: "Problem set, Week 7: Final exam training session"
author: "Your name here"
date: "today's date here"
output: html_document
---

<head>
<link 
  rel="stylesheet" 
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <script src="https://kit.fontawesome.com/03064bdd6c.js" crossorigin="anonymous"></script>
</head>


```{css, echo = FALSE}
.score {
  font-weight: bold;
  font-size: 16px;
  color: red;
  background-color: #ffff80;
}

.now_you {
  border-left: 8px solid #292093;
  background-color: #e6ffff;
  padding: 16px;
  margin-top: 15px;
  margin-bottom: 15px;
}


.fas {
  font-size:36px
}

.subscore {
  font-size: 14px;
  color: red;
}

.accordion {
  background-color: #e6f0ff;
  color: #000000;
  cursor: pointer;
  padding: 18px;
  width: 100%;
  border-style: solid;
  border-width: 2px;
  border-color: #ffffff;
  text-align: left;
  outline: none;
  font-size: 15px;
  transition: 0.4s;
}

.active, .accordion:hover {
  background-color: #80b3ff; 
  color: #ffffff;
  font-weight: bold;
}

.panel {
  padding: 0 18px;
  display: none;
  background-color: #eeffff;
  overflow: hidden;
}

h2 {
  padding-top: 18px;
}
```


```{r knitr_setup, include = FALSE}
options(knitr.table.format = "html")
library(tidyverse)
```

<hr>
      

<div class = "row" style = "margin-left: .25em; font-size: 16px;">
<img 
    src="https://assets0.roadtrippers.com/uploads/trip/uploaded_image/14715223/-quality_60_-interlace_Plane_-resize_640x500_U__-gravity_center_-extent_640x500/trip-uploaded_image-9a10d75c-f676-4680-8c22-ae8273bb3911.jpg" 
    style = "float: left;
      margin-top: 1.5rem;
      margin-right: 2rem;
      margin-bottom: 1rem;
      margin-left: 0.5rem;
      width: 40%;">

This problem set will be quite different from the others. There is no lofty ecological goal, no narrative to follow, not even any birds (well, maybe a few birds), cats, or cicadas. Instead, the singular goal of this problem set is to prepare you for the final project (which is really more of a take-home, open book, final exam). I've provided several (mostly) toy data sets that are similar to the ones that I create and use during Review and Q & A sessions, office hours, and on the discussion board. My hope is that the combination of these toy datasets and questions that represent some of the head-scratching puzzles we often encounter when wrangling real data will help make your final project much less stressful!

Please note that I have provided a lifeline file (`data/processed/problem_set_7_lifelines.rds`) for each question and include hints from that file throughout.

</div>


## Grading
<hr>

The points allotted for each question are provided in highlighted red bold text (e.g., <span class = "score">[1.0]</span>) within the question itself. When applicable, total points for a question may represent the sum of individually graded components, which are provided in red text (e.g., <span class = "subscore">[1.0]</span>).

Points may be deducted from each question's total: 

* Use only functions other than those listed in "Functions that you may use in this assignment" [50%]
* Do not include any assignments other than those specified in the question [50%]
* Unless specified otherwise, each question must be answered in a single piped statement [50%]
* Include a comment at the start of each code block [25%]
* Include a comment for each line of code that modifies a dataset [10% per violation]
* Ensure that all code is properly indented [10% per violation]
* Ensure that your code follows modern coding conventions (see *Best practices in modern R coding*) [10% per violation]

*Note: The maximum deduction is the total points value for a given question*

You must ensure that your R Markdown document **runs out-of-the-box** -- in other words, the document will knit without error. Some tips for doing so:

* Do not maintain your project folder in a location that is backed up by an online directory (e.g., Dropbox, iCloud)
* Ensure that all file paths are equivalent to those in this document (e.g., in `source()` or `read_csv()`)
* Do not use `setwd()` in your code (***Never** use `setwd()`!*)
* If one of your code chunks contains an error, include `eval = FALSE` in the options for that chunk
* Prior to submission, clear all objects from your global environment prior to knitting your R Markdown document
<hr>

<div>
<button class="accordion">Functions that you may use in this assignment</button>
<div class="panel">

In this assignment, you may use **only** the following R functions (*Note: If you are unclear on what a given function does, use `?` to view the help file!*):

* base::<-
* base::=
* base:: :
* base::()
* base::~
* base::==
* base::!
* base::<
* base::>
* base::<=
* base::>=
* base::&
* base::library
* base::list2env
* base::unique
* dplyr::across
* dplyr::anti_join
* dplyr::case_when
* dplyr::filter
* dplyr::group_by
* dplyr::if_else
* dplyr::join_by
* dplyr::mutate
* dplyr::n
* dplyr::pull
* dplyr::select
* dplyr::semi_join
* dplyr::slice_max
* dplyr::summarize
* forcats::fct_reorder
* ggplot2::+
* ggplot2::aes
* ggplot2::coord_flip
* ggplot2::geom_bar
* ggplot2::ggplot
* ggplot2::labs
* lubridate::as_datetime
* lubridate::hour
* lubridate::mdy
* lubridate::month
* magrittr::%>%
* purrr::map
* purrr::pluck
* readr::read_rds
* stringr::str_c
* stringr::str_replace

</div>
</div>


## The setup
<hr>

Open R Studio. Remember that it's best practice to start with a clean R Studio session (i.e., close any script files, remove objects from your global environment, and clear your history).

:::: {.now_you}

<i class="fas fa-user-circle"></i> 

1\. [[0.50]]{.score} Save and knit this document:

* [[0.1]]{.subscore} Replace my name in the YAML header with yours
* [[0.1]]{.subscore} Add the current date in the YAML header
* [[0.3]]{.subscore} Save the *.rmd* in the **top level of your project folder** as (*but replace my name with yours*): `problem_set_7_Evans_Brian.rmd` 

::::

:::: {.now_you}

<i class="fas fa-user-circle"></i> 

2\. [[0.50]]{.score} Load the `tidyverse` library.

```{r 2-tidyverse, results = 'hide'}
# Paste your code here!
```

::::

### The data
<hr>

The data file for this assignment is `problem_set_7_data.rds`. This file contains a variety of weird little objects that I generated to help you address certain puzzles during your final. 

:::: {.now_you}

<i class="fas fa-user-circle"></i> 

3\. [[0.50]]{.score}  Read in `"data/raw/problem_set_7_data.rds"` and assign each of the list items to your global environment. 

```{r 3-read_data, results = 'hide'}

# Paste your code here!

```
::::

## Backwards columns
<hr>

A common problem in data management is column values that have been reversed!

:::: {.now_you}
<i class="fas fa-user-circle"></i> 

4. [[1.0]]{.score} In `backwards_columns`, column `a` is intended to contain only negative numbers and column `b` is intended to contain only positive numbers. If column `a` is negative and column `b` is positive, switch the values between the two columns:

```{r backwards_columns}

# Paste your code here!

```

::::

**Hint**: Your final answer should be equivalent to:

```{r backwards_columns_answer, echo = FALSE}
read_rds("data/processed/problem_set_7_lifelines.rds") %>% 
  pluck("question_4")
```


## Regex-ellence
<hr>

The dataset `bad_birds` is a vector of three species with lots of spelling errors!

:::: {.now_you}

<i class="fas fa-user-circle"></i> 

5\. [[1.5]]{.score} As parsimoniously as possible, fix the spellings of the common names to "House finch", "House sparrow", and "House wren":

```{r 5-regex}

# Paste your code here!

```

::::

**Hint**: Your final answer should be equivalent to:

```{r 5-regex_answer, echo = FALSE}
read_rds("data/processed/problem_set_7_lifelines.rds") %>% 
  pluck("question_5")
```

## Anti and semi joins
<hr>

The list object `matching_list_tables` contains two tables, `boy` and `howdy`.
The column `heroes` in `boy` corresponds with the column `hello` in `howdy`.

:::: {.now_you}

<i class="fas fa-user-circle"></i> 

6\. [[1.0]]{.score} Without using filter, subset the table `boy` in `matching_list_tables` such that only rows in which the value of column `heroes` has a corresponding value in the column `hello` of table `howdy`:

```{r 6-joins}

# Paste your code here!

```

::::

**Hint**: Your final answer should be equivalent to:

```{r 6-joins_answer, echo = FALSE}
read_rds("data/processed/problem_set_7_lifelines.rds") %>% 
  pluck("question_6")
```

:::: {.now_you}

<i class="fas fa-user-circle"></i> 

7\. [[1.0]]{.score} Without using filter, subset the table `boy` in `matching_list_tables` such that only rows in which the value of column `heroes` does not have a corresponding value in the column `hello` of table `howdy`:

```{r 7-joins}

# Paste your code here!

```

::::

**Hint**: Your final answer should be equivalent to:

```{r 7-joins_answer, echo = FALSE}
read_rds("data/processed/problem_set_7_lifelines.rds") %>% 
  pluck("question_7")
```

## Butterflies and moths
<hr>

:::: {.now_you}

<i class="fas fa-user-circle"></i> 

8\. [[1.5]]{.score} The dataset `leps_dc` contains all of the observations of Lepidoptera in Washington DC in 2021.

* [[0.5]]{.subscore} Are these data tidy? If not, which tidy data rule does the table violate?

[your answer here]{style=color:blue;font-size:18px;}

* [[1.0]]{.subscore} Subset the data to observations of the three species with the most total number of observations across time and assign the name `common_leps` to the resultant object.

```{r 8-leps}

# Paste your code here!

```

::::

**Hint**: Your final answer should be equivalent to:

```{r 8-leps_answer, echo = FALSE}
read_rds("data/processed/problem_set_7_lifelines.rds") %>% 
  pluck("question_8")
```

:::: {.now_you}

<i class="fas fa-user-circle"></i> 

[[Extra credit 1.0]]{.score} Using a iteration, create three bar plots of the number of
observations per month for each of the three most commonly observed
Lepidoptera species. In doing so:

* [[0.25]]{.subscore} Label the x-axis with month abbreviations (e.g., Apr, May, Jun) 
* [[0.25]]{.subscore} Include the scientific name of the species as the title of the plot

```{r extra-credit_1}

# Paste your code here!

```

::::

## Seems like old times
<hr>

The object `dates_and_times` contains a date and two times in which an event occurred.

:::: {.now_you}

<i class="fas fa-user-circle"></i> 

9\. [[1.5]]{.score} Please modify `dates_and_times`:

* [[0.25]]{.subscore} Convert date to an ISO-8601 date object
* [[0.50]]{.subscore} Convert time1 and time2 to a ISO-8601 date-time object
* [[0.25]]{.subscore} Subset the data to where time2 occurs after time 1
* [[0.50]]{.subscore} Replace time1 and time2 with the hour associated with the time

```{r 9-time}

# Paste your code here!

```

::::

**Hint**: Your final answer should be equivalent to:

```{r 9-time_answer, echo = FALSE}
read_rds("data/processed/problem_set_7_lifelines.rds") %>% 
  pluck("question_9")
```

## Casing the joint
<hr>

The dataset `size_and_volume` represents the observations of different individuals, their size, and how loud they were. 

:::: {.now_you}

<i class="fas fa-user-circle"></i> 

10\. [[1.0]]{.score} As parsimoniously as possible create a column called `species` where:

* [[0.25]]{.subscore} Sizes less than 10 and volumes less than or equal to 30 are classified as a "Deer mouse"
* [[0.25]]{.subscore} Sizes less than 10 and volumes greater than 30 are classified as a "House wren"
* [[0.25]]{.subscore} Sizes great than or equal to 10 and volumes less than or equal to 30 are classified as a "Three-toed sloth"
* [[0.25]]{.subscore} Sizes great than or equal to 10 and volumes greater than 30 are classified as a "Howler monkey"

```{r 10-case}

# Paste your code here!

```

::::

**Hint**: Your final answer should be equivalent to:

```{r 10-case_answer, echo = FALSE}
read_rds("data/processed/problem_set_7_lifelines.rds") %>% 
  pluck("question_10")
```

:::: {.now_you}

<i class="fas fa-user-circle"></i> 

[[Extra credit 1.0]]{.score} Create a bar plot of the number of observations of each species where:

* Species are on the y-axis and the count is on the x-axis
* The bars are arranged by the number of observations per species

```{r extra-credit_2}

# Paste your code here!

```

::::

## Submission
<hr>

Please save your R markdown (.Rmd) file and submit **only that file** to Blackboard.



<script>
var acc = document.getElementsByClassName("accordion");
var i;

for (i = 0; i < acc.length; i++) {
  acc[i].addEventListener("click", function() {
    this.classList.toggle("active");
    var panel = this.nextElementSibling;
    if (panel.style.display === "block") {
      panel.style.display = "none";
    } else {
      panel.style.display = "block";
    }
  });
}
</script>

